
<!-- saved from url=(0097)https://script.google.com/a/macros/domovpromne.cz/library/d/MnG63u59Ch9RE0E4dprsu05SID2c2_1-P/106 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Library Documentation</title><link rel="stylesheet" type="text/css" href="./Library Documentation_files/screen-docs.css"><link href="./Library Documentation_files/css" rel="stylesheet" type="text/css"><style type="text/css">/* This is not a zero-length file! */</style><style type="text/css">/* This is not a zero-length file! */</style></head><body class="two-column docs"><div id="gc-wrapper"><div id="gc-main" class="main"><div id="gc-content" style="margin-left:0"><h1 class="page_title">Utils (version 106)</h1><p>new formatting</p><h2>createEmployee(Object user)</h2><p>Insert User(employee) into database
user has properties leadsGroups or isInGroups which are arrays and this function inserts them into diferent tables of database too</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>user</td><td><code>Object</code></td><td>User(employee) object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>getUserEmail()</h2><p>Gets active User email.</p><h2>validate(Object errorResult, Object input, Object processObj)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>errorResult</td><td><code>Object</code></td><td></td></tr><tr><td>input</td><td><code>Object</code></td><td></td></tr><tr><td>processObj</td><td><code>Object</code></td><td></td></tr></tbody></table><h2>findGroupsAsArray()</h2><p></p><h2>getWeekNumber(Object dateObj)</h2><p>This script is released to the public domain and may be used, modified and distributed without restrictions. Attribution not necessary but appreciated.

Source: http://weeknumber.net/how-to/javascript
Returns the ISO week of the date.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>dateObj</td><td><code>Object</code></td><td>Date</td></tr></tbody></table><h2>hasAccessToSomeOf(Object accessEnumArray, Object permissionType)</h2><p>Checks if active user has access to at least one of resource (specified as accessEnum).</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>accessEnumArray</td><td><code>Object</code></td><td>resources array to find access for</td></tr><tr><td>permissionType</td><td><code>Object</code></td><td>Type of permission for resource we need to know</td></tr></tbody></table><h2>isSuperAdmin(Object email)</h2><p>Checks if email is super admin or if active user is (in case email == null).</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>email</td><td><code>Object</code></td><td>email to be checked or null to check active user</td></tr></tbody></table><h2>createTrigger(Object trigger)</h2><p>Insert Trigger into database and sets emailSequence for trigger.email as increment of the last greatest one for this user</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>trigger</td><td><code>Object</code></td><td>trigger with email property</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>updateFile(Object file)</h2><p>Updates file/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>file</td><td><code>Object</code></td><td>object with property id</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>findGroupClients(Object fields, Object restrictions)</h2><p>Finds group Clients from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object key/value pairs for selecting rows</td></tr></tbody></table><h2>getUserObjProp(Object key)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>key</td><td><code>Object</code></td><td>key of object in UserProperties</td></tr></tbody></table><h2>setUserProps(Object obj)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>obj</td><td><code>Object</code></td><td>object with multiple properties to be set in UserProperties</td></tr></tbody></table><h2>deleteFile(Object file)</h2><p>Delete file/s from database based on its properties
Moves file to trash in Google Drive</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>file</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>updateClient(Object client)</h2><p>Updates client/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>client</td><td><code>Object</code></td><td>object with name property as id</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>findGroupLeaders(Object fields, Object restrictions)</h2><p>Finds group Leaders from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object key/value pairs for selecting rows</td></tr></tbody></table><h2>createFile(Object file)</h2><p>Insert file into database with current time</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>file</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>deleteGroupLeader(Object groupLeader, Object hasMoreInstances)</h2><p>Delete group Leader/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>groupLeader</td><td><code>Object</code></td><td>object</td></tr><tr><td>hasMoreInstances</td><td><code>Object</code></td><td>if true turns off error logging if object has more instances</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>getWeekDaysNames()</h2><p></p><h2>createClient(Object client)</h2><p>Insert Client into database</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>client</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>updateEmployee(Object user)</h2><p>Updates User(employee)/s from database based on its properties
We can choose by property isUpdatable = false that we don't want to update user
Updates groups user is in and leads every time</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>user</td><td><code>Object</code></td><td>User(employee) object with property email as id</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>compareDates(Object first, Object second)</h2><p>Compares dates between first and second and returns difference</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>first</td><td><code>Object</code></td><td>Date</td></tr><tr><td>second</td><td><code>Object</code></td><td>Date</td></tr></tbody></table><h2>getUserPermission(Object email)</h2><p>Finds user permission of email or active user (in case email == null).
Caches userPermission for time which can be set in Script Properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>email</td><td><code>Object</code></td><td>email to be checked or falsy value to check active user</td></tr></tbody></table><h2>updateTrigger(Object trigger)</h2><p>Updates trigger/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>trigger</td><td><code>Object</code></td><td>object with property id</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>createGroupClient(Object groupClient)</h2><p>Insert Group Client into database</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>groupClient</td><td><code>Object</code></td><td></td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>getFormatedDate(Object date, Object differentType)</h2><p>Returns formatted date
@differentType if true uses . , otherwise - as separator</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>date</td><td><code>Object</code></td><td>Date</td></tr><tr><td>differentType</td><td><code>Object</code></td><td></td></tr></tbody></table><h2>getAllSpreadSheetData(Object from, Object to)</h2><p>Extracts all valid data from 'Rozpis' files in defined time span.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>from</td><td><code>Object</code></td><td>from which date to start extracting</td></tr><tr><td>to</td><td><code>Object</code></td><td>to which date extract data</td></tr></tbody></table><h2>createEvent(Object event)</h2><p>Insert Event into database</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>event</td><td><code>Object</code></td><td></td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>getMyAccessRightsNames()</h2><p>Returns names and permission of all users roles active user can edit and create</p><h2>hasAccessTo(Object accessEnum, Object permissionType)</h2><p>Checks if active user has access to resource (specified as accessEnum).</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>accessEnum</td><td><code>Object</code></td><td>resource we need to have access</td></tr><tr><td>permissionType</td><td><code>Object</code></td><td>Type of permission for resource we need to know</td></tr></tbody></table><h2>getNextMonday(Object monday)</h2><p>Returns next monday.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>monday</td><td><code>Object</code></td><td>Date</td></tr></tbody></table><h2>createGroupLeader(Object groupLeader)</h2><p>Insert Group Leader into database</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>groupLeader</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>getUserProp(Object key)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>key</td><td><code>Object</code></td><td>key of object in UserProperties</td></tr></tbody></table><h2>deleteTrigger(Object trigger)</h2><p>Delete trigger/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>trigger</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>deleteGroupActor(Object groupActor, Object hasMoreInstances)</h2><p>Delete group Actor/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>groupActor</td><td><code>Object</code></td><td>object</td></tr><tr><td>hasMoreInstances</td><td><code>Object</code></td><td>if true turns off error logging if object has more instances</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>findFiles(Object fields, Object restrictions)</h2><p>Finds files from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object of key/value pairs for selecting rows</td></tr></tbody></table><h2>extractSpreadSheet(Object sheet, Object extractDays)</h2><p>Extracts data from one spreadsheet</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>sheet</td><td><code>Object</code></td><td>from which date to start extracting</td></tr><tr><td>extractDays</td><td><code>Object</code></td><td></td></tr></tbody></table><h2>deleteGroupClient(Object groupClient, Object hasMoreInstances)</h2><p>Delete group Client/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>groupClient</td><td><code>Object</code></td><td></td></tr><tr><td>hasMoreInstances</td><td><code>Object</code></td><td>if true turns off error logging if object has more instances</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>setUserObjProp(Object key, Object value)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>key</td><td><code>Object</code></td><td>key for object to be set in UserProperties</td></tr><tr><td>value</td><td><code>Object</code></td><td>object to be set</td></tr></tbody></table><h2>createTariff(Object tariff)</h2><p>Insert Tariff into database</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>tariff</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>isObjErrorFree(Object obj)</h2><p>Checks if obj is error free, error is property which is non empty string.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>obj</td><td><code>Object</code></td><td>to be searched for errors</td></tr></tbody></table><h2>getMonthsNames()</h2><p></p><h2>setUserProp(Object key, Object value)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>key</td><td><code>Object</code></td><td>key for object to be set in UserProperties</td></tr><tr><td>value</td><td><code>Object</code></td><td>string to be set</td></tr></tbody></table><h2>trim(Object str)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>str</td><td><code>Object</code></td><td>string to be trimmed of white spaces and apppostrophes '</td></tr></tbody></table><h2>createGroupActor(Object groupActor)</h2><p>Insert Group Actor into database</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>groupActor</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>updateTariff(Object tariff)</h2><p>Updates tariff/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>tariff</td><td><code>Object</code></td><td>object with shortcut property as id</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>getOlderWeek(Object day, Object week, Object numberOfWeeksBack)</h2><p>Roll backs by number of weeks.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>day</td><td><code>Object</code></td><td>year part is parsed from it</td></tr><tr><td>week</td><td><code>Object</code></td><td>week</td></tr><tr><td>numberOfWeeksBack</td><td><code>Object</code></td><td>number of weeks to roll back</td></tr></tbody></table><h2>getThisWeeksSunday(Object monday)</h2><p>Returns This week's Sunday.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>monday</td><td><code>Object</code></td><td>Date</td></tr></tbody></table><h2>validateGroups(Object formObject, Object errorMsg, Object type, Object oldUser)</h2><p>Checks if we have permision to change users groups which are defined in formObject.
sets error messages to errorMsg object if we try to edit groups which we are not authorized to</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>formObject</td><td><code>Object</code></td><td>object representing form in javascript i.e. new user</td></tr><tr><td>errorMsg</td><td><code>Object</code></td><td>object to be set if groups are set invalidly</td></tr><tr><td>type</td><td><code>Object</code></td><td>object  which can be either 'groupLeader' or 'isInGroup' and switches validation</td></tr><tr><td>oldUser</td><td><code>Object</code></td><td>object representing users groups before editation</td></tr></tbody></table><h2>getMonday(Object day)</h2><p>Checks if today is monday or returns last monday.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>day</td><td><code>Object</code></td><td>Date</td></tr></tbody></table><h2>findGroups(Object restrictions, Object limit)</h2><p>Finds groups from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object of key/value pairs for selecting rows</td></tr><tr><td>limit</td><td><code>Object</code></td><td>maximum number of rows to be returned</td></tr></tbody></table><h2>compareTimes(Object first, Object second)</h2><p>Compares times of Dates between first and second and returns difference</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>first</td><td><code>Object</code></td><td>Date</td></tr><tr><td>second</td><td><code>Object</code></td><td>Date</td></tr></tbody></table><h2>getMyAccessRights(Object type)</h2><p>Returns all Accesses current user is possesing for permission type.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>type</td><td><code>Object</code></td><td>Permission Type  to find</td></tr></tbody></table><h2>getUserRolesInCzech()</h2><p>Gets User permissions neatly sorted and with Czech Transaltions</p><h2>deleteEvent(Object event, Object hasMoreInstances)</h2><p>Delete Event/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>event</td><td><code>Object</code></td><td></td></tr><tr><td>hasMoreInstances</td><td><code>Object</code></td><td>if true turns off error logging if object has more instances</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>findTariffs(Object fields, Object restrictions)</h2><p>Finds tariffs from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object of key/value pairs for selecting rows</td></tr></tbody></table><h2>findGroupActors(Object fields, Object restrictions)</h2><p>Finds group Actors from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object key/value pairs for selecting rows</td></tr></tbody></table><h2>createGroup(Object group)</h2><p>Insert Group into database</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>group</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>toUniquePrimitiveArray(Object a)</h2><p>Returns new unique array.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>a</td><td><code>Object</code></td><td>array of primitive types</td></tr></tbody></table><h2>deleteGroup(Object group)</h2><p>Delete group/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>group</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>findClients(Object fields, Object restrictions)</h2><p>Finds clients from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object of key/value pairs for selecting rows</td></tr></tbody></table><h2>deleteProp(Object key)</h2><p></p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>key</td><td><code>Object</code></td><td>of object to delete in UserProperties</td></tr></tbody></table><h2>getMyGroupsWithEditAtrs(Object user)</h2><p>Finds all existing groups and adds attributes for adding other users to those groups by user/client or active user (in case user == null).</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>user</td><td><code>Object</code></td><td>user/client to be checked or null to check active user</td></tr></tbody></table><h2>logError(Object msg)</h2><p>Logs error to Log SpreadSheet</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>msg</td><td><code>Object</code></td><td>message to be logged</td></tr></tbody></table><h2>deleteTariff(Object tariff)</h2><p>Delete tariff/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>tariff</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>findEvents(Object fields, Object restrictions)</h2><p>Finds Events from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object key/value pairs for selecting rows</td></tr></tbody></table><h2>deleteClient(Object client)</h2><p>Delete client/s from database based on its properties</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>client</td><td><code>Object</code></td><td>object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>log(Object msg)</h2><p>Logs message to Log SpreadSheet</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>msg</td><td><code>Object</code></td><td>message to be logged</td></tr></tbody></table><h2>convertObjectsToArrayByProperty(Object array, Object property)</h2><p>Returns new array which is filled with object[property] of objects in array.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>array</td><td><code>Object</code></td><td>array of objects</td></tr><tr><td>property</td><td><code>Object</code></td><td>to be looked for</td></tr></tbody></table><h2>prepareSheet(Object sheet, Object day, Object messages)</h2><p>Formatts sheet as schedule.</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>sheet</td><td><code>Object</code></td><td>to be formatted</td></tr><tr><td>day</td><td><code>Object</code></td><td>date which is the beginning of week (should be monday)</td></tr><tr><td>messages</td><td><code>Object</code></td><td>array of strings of length 3, these strings are going to be shown in a sheet</td></tr></tbody></table><h2>createSpreadsheet(Object obj)</h2><p>Creates SpreadSheet and names it and stores it in location depending on obj.type.
  Possible values for type are 'Rozpis' 'Statistika' and 'Fakturace'</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>obj</td><td><code>Object</code></td><td>object which can have properties type, year, week, group</td></tr></tbody></table><h2>deleteEmployee(Object user)</h2><p>Delete User(employee)/s from database based on its properties.
Also deletes all groups user is in or leads</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>user</td><td><code>Object</code></td><td>User(employee) object object</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>boolean</code></td><td>indicating success or failure.</td></tr></tbody></table><h2>findEmployees(Object fields, Object restrictions)</h2><p>Finds users(employees) from database based on restrictions
returns them with groups user leads or is in</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object of key/value pairs for selecting rows</td></tr></tbody></table><h2>findTriggers(Object fields, Object restrictions, Object limit)</h2><p>Finds triggers from database based on restrictions</p><h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>fields</td><td><code>Object</code></td><td>fields is array of strings . It assigns these strings as properties to final objects</td></tr><tr><td>restrictions</td><td><code>Object</code></td><td>object of key/value pairs for selecting rows</td></tr><tr><td>limit</td><td><code>Object</code></td><td>maximum number of rows to be returned</td></tr></tbody></table></div></div></div></body></html>