<!-- saved from url=(0100)https://script.google.com/a/macros/domovpromne.cz/library/d/MKjOsnqH-RNddlGah3U7GwZSID2c2_1-P/GS:web -->
<html>

<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Library Documentation</title>
  <link rel="stylesheet" type="text/css" href="../css/screen-docs.css">
  <link href="../css/css" rel="stylesheet" type="text/css">
  <style type="text/css">
  /* This is not a zero-length file! */
  </style>
  <style type="text/css">
  /* This is not a zero-length file! */
  </style>
</head>

<body class="two-column docs">
  <div id="gc-wrapper">
    <div id="gc-main" class="main">
      <div id="gc-content" style="margin-left:0">
      <a href="../index.html">
          <font class="link">
            <b>Home</b>
          </font>
        </a>
        <h1 class="page_title">EmailSender</h1>
        <h2>includeAndEvaluate(Object filename)</h2>
        <p>Evaluates GAS scriptlets and includes HMTL from a file. *just shortcut a for a long command</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>filename</td>
              <td><code>Object</code></td>
              <td>name of file to be included</td>
            </tr>
          </tbody>
        </table>
        <h3>Return Values:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="width: 20%;">Type</th>
              <th scope="col" style="width: 80%;">Description</th>
            </tr>
            <tr>
              <td><code>string</code></td>
              <td>string of result html</td>
            </tr>
          </tbody>
        </table>
        <h2>initialize()</h2>
        <p>Init clients array to manager</p>
        <h2>getProp(Object prop)</h2>
        <p>Wrapper function.</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>prop</td>
              <td><code>Object</code></td>
              <td></td>
            </tr>
          </tbody>
        </table>
        <h2>processClients(Object formObject)</h2>
        <p>prepares sheets for clients and sends emails</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>formObject</td>
              <td><code>Object</code></td>
              <td>form with emails and message</td>
            </tr>
          </tbody>
        </table>
        <h3>Return Values:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="width: 20%;">Type</th>
              <th scope="col" style="width: 80%;">Description</th>
            </tr>
            <tr>
              <td><code>string</code></td>
              <td>success string</td>
            </tr>
          </tbody>
        </table>
        <h2>setRuntimeProperties(Object params)</h2>
        <p>Sets runtime properties</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>params</td>
              <td><code>Object</code></td>
              <td>object with properties to set</td>
            </tr>
          </tbody>
        </table>
        <h2>processForm(Object formObject)</h2>
        <p>Processes form and returns result.</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>formObject</td>
              <td><code>Object</code></td>
              <td>Form object</td>
            </tr>
          </tbody>
        </table>
        <h3>Return Values:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="width: 20%;">Type</th>
              <th scope="col" style="width: 80%;">Description</th>
            </tr>
            <tr>
              <td><code>Object</code></td>
              <td>object which designates success or failure</td>
            </tr>
          </tbody>
        </table>
        <h2>preparePayloadAndEmail(Object email, Object body, Object mainSheetData, Object mainSS, Object payloadSS, Object mainSheet, Object payloadSheet, Object payloadAsFile)</h2>
        <p>prepares sheets for clients and sends emails</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>email</td>
              <td><code>Object</code></td>
              <td>email address</td>
            </tr>
            <tr>
              <td>body</td>
              <td><code>Object</code></td>
              <td>body of email</td>
            </tr>
            <tr>
              <td>mainSheetData</td>
              <td><code>Object</code></td>
              <td>data to insert into sheet</td>
            </tr>
            <tr>
              <td>mainSS</td>
              <td><code>Object</code></td>
              <td>main SpreadSheet resource</td>
            </tr>
            <tr>
              <td>payloadSS</td>
              <td><code>Object</code></td>
              <td>SpreadSheet for email attachment</td>
            </tr>
            <tr>
              <td>mainSheet</td>
              <td><code>Object</code></td>
              <td>main sheet resource</td>
            </tr>
            <tr>
              <td>payloadSheet</td>
              <td><code>Object</code></td>
              <td>sheet for email attachment</td>
            </tr>
            <tr>
              <td>payloadAsFile</td>
              <td><code>Object</code></td>
              <td>link to drive for email attachment</td>
            </tr>
          </tbody>
        </table>
        <h3>Return Values:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="width: 20%;">Type</th>
              <th scope="col" style="width: 80%;">Description</th>
            </tr>
            <tr>
              <td><code>string</code></td>
              <td>success string</td>
            </tr>
          </tbody>
        </table>
        <h2>createPresentableHTML(Object content, Object sourceType, Object title)</h2>
        <p>Creates presentable HTML for a browser *cannot be run from library, becaouse of filename</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>content</td>
              <td><code>Object</code></td>
              <td>depends on a sourceType, if sourceType isn't string, it includes file with name == content</td>
            </tr>
            <tr>
              <td>sourceType</td>
              <td><code>Object</code></td>
              <td>is string indicating values 'string'/'file' for source type, takes file as default for any other value</td>
            </tr>
            <tr>
              <td>title</td>
              <td><code>Object</code></td>
              <td>title of a window</td>
            </tr>
          </tbody>
        </table>
        <h3>Return Values:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="width: 20%;">Type</th>
              <th scope="col" style="width: 80%;">Description</th>
            </tr>
            <tr>
              <td><code>Object</code></td>
              <td>html object</td>
            </tr>
          </tbody>
        </table>
        <h2>include(Object filename)</h2>
        <p>Includes HMTL from a file. *just shortcut a for a long command</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>filename</td>
              <td><code>Object</code></td>
              <td>name of file to be included</td>
            </tr>
          </tbody>
        </table>
        <h3>Return Values:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="width: 20%;">Type</th>
              <th scope="col" style="width: 80%;">Description</th>
            </tr>
            <tr>
              <td><code>string</code></td>
              <td>string of html</td>
            </tr>
          </tbody>
        </table>
        <h2>doGet(Object e)</h2>
        <p>Serves HTML</p>
        <h3>Arguments:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="wdith: 20%;">Name</th>
              <th scope="col" style="width: 15%;">Type</th>
              <th scope="col" style="width: 65%;">Description</th>
            </tr>
            <tr>
              <td>e</td>
              <td><code>Object</code></td>
              <td>url parameters setting this webapp's beahviour</td>
            </tr>
          </tbody>
        </table>
        <h3>Return Values:</h3>
        <table style="width: 100%">
          <tbody>
            <tr>
              <th scope="col" style="width: 20%;">Type</th>
              <th scope="col" style="width: 80%;">Description</th>
            </tr>
            <tr>
              <td><code>Object</code></td>
              <td>HTML page with javascript</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>

</html>
