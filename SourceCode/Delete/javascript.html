<!-- Javascript which is served with main.html. It's purpose is to call delete, and resolve success or failure  -->
<script src='//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js'></script>
<script>
$(document).ready(function() {
  $('#submitButton').click(function() {
    $('#bottomDiv').hide();
    $('#loading').show();

    google.script.run.withSuccessHandler(function(obj) {
      resolveResponse(obj);
    }).del();

    return false;
  });
});

function resolveResponse(obj) {
  $('#loading').hide();
  if (obj.err) {
    $('#err').text(obj.err);
    $('#errorDiv').show();
  } else {
    google.script.run.withSuccessHandler(function(obj) {
      $('#finalMessage').text(obj ? '\nKe zrušení práv uživatele dojde nejzpoději do 2 hodin.\nV akutním případě kontaktujte super admina.\n' : '');
    }).hasSitesPermission();
    $('#message').text(obj.message);
    $('#bottomDiv').show();
    $('#submitButton').hide();
  }
}
</script>
